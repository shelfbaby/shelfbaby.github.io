import{r as e,j as t,d as a,v as n,aj as i,ak as s,al as u,am as r}from"./index-ae48b77e.js";const d=e.createContext({eventSent:!1,setEventSent:e=>{}}),o=({children:a})=>{const[n,i]=e.useState(!1);return t.jsx(d.Provider,{value:{eventSent:n,setEventSent:i},children:a})},c=()=>e.useContext(d),l=({children:e,event:n="page_view",data:i})=>{const{loading:s}=a();return s?e:t.jsx(g,{event:n,data:i,children:e})},g=({children:t,event:d="page_view",data:o})=>{const{guild:l}=n(),{loading:g}=a(),m=e.useRef(""),_=window.location.pathname,p=i.useFlags(),{setEventSent:f}=c();return e.useEffect((()=>{const e=window&&window?.dataLayer?window?.dataLayer:[];let t={};if(window.location.search){const e=new URLSearchParams(window.location.search);t={utm_source:e.get("utm_source"),utm_medium:e.get("utm_medium"),utm_campaign:e.get("utm_campaign"),utm_term:e.get("utm_term"),utm_content:e.get("utm_content")}}if(g)return;const a=e?.filter((e=>"page_view"===e?.event)).pop();if(a&&a?.page_url===_)return;const n=d,i={...t,page_name:s(_),page_category:_.includes("dashboard")?"dashboard":"non_logged_website",page_url:_,page_previous_url:m.current,page_environment:"production",guild_buffs:l?.buffs,guild_discord_features:l?.features,guild_plugins:l?.plugins?Object.values(l.plugins).filter((e=>e?.config?.enabled)).map((e=>e.id)):[],guild_id:l?.id,guild_is_premium:l?.buffs?.includes("premium"),guild_is_premium_gift:l?.buffs?.includes("premium-gift"),guild_member_count:l?.member_count,guild_category:l?.discord_usage,guild_is_business:l?.is_business,...o},c={dataLayer:{event:d,...i,eventCallback:function(){f(!0)}},dataLayerName:"dataLayer"};u.dataLayer(c),r(n,i),m.current=_}),[location.pathname,g,p]),t};export{o as D,l as G,c as u};
